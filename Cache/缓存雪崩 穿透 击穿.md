#Cache #CacheAvalanche #CachePenetration #CacheBreakdown #Todo 

# 缓存雪崩
- **Cache Avalanche**
- 缓存集中失效（*same expiration time*，will *fail at the same time*）；
- 或者缓存系统出现故障。
- 缓存层阻挡了大量请求，保护了存储层。缓存的集中失效或者缓存系统的故障，将导致存储层请求激增，甚至出现级联（cascade）故障停机。

![[redis缓存雪崩示意.png]]


## 解决

- 常用的方案是*保证 Redis 的高可用*：
	1.  Redis 高可用，如 Redis *Sentinel* or Redis *Cluster*。
- **限流降级**：
	1. 例如，缓存失效后，通过*加锁或者队列来控制读数据库*的线程数量。
	2. 如设置某些 Key 只允许一个线程查询数据和写缓存，其他线程等待。
- **数据预热**。
	1. 将可能大量访问的数据加载到缓存；
	2. 在即将发生大并发访问的时候，提前手动触发加载不同的数据到缓存中，并为数据设置不同的过期时间，让缓存失效的时间点尽量均匀，不至于在同一时刻全部失效。

# 缓存穿透
- **Cache Penetration**
- 请求数据时，在缓存层和数据库层都不存在。
- Cache penetration causes non-existent data to be queried to the storage layer every time a request is made, *losing the meaning of cache protection for back-end storage*。

原因可能有两种：
- 业务代码问题；
- 多次恶意请求空对象；


## 解决
- 缓存空对象。当第一次从数据库中查询出来的结果为空时，将空对象加载到缓存，并设置合理的过期时间。
- 布隆过滤器，布隆过滤器可以针对大数据量的、有规律的键值进行处理。

# 缓存击穿
Hotspot Invalid



# 参考
1. [【高并发】面试官：讲讲什么是缓存穿透？击穿？雪崩？如何解决？](https://xie.infoq.cn/article/39495c2d568aca1d6db5c9c50)
2. [Redis Cache Penetration, Cache Breakdown, Cache Avalanches and Solutions](https://www.fatalerrors.org/a/redis-cache-penetration-cache-breakdown-cache-avalanches-and-solutions.html)