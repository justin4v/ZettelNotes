#Encryption #Symmetric-encryption #Asymmetric-encryption

# 角色
Bob ：通信的第一参与者
Alice：通信的第二参与者
Eve：黑客，窃听者

# 对称加密
- *加密解密使用同一个密钥*，称为共享密钥；
- Bob 给 Alice 发消息，在此之前双方先约定好使用一个对称密钥，在双方通信的过程中传输的消息全是密钥加密后的密文；
- 常见的 **对称加密** 算法主要有 `DES`、`3DES`、`AES` 等;
![[对称加密过程示意.png]]

- 最流行的*对称加密算法 AES（Advanced Encryption Standrad）*，密钥长度可以是 128，192 或 256 位。
- *密钥安全交换*：如果黑客在密钥传递的途中窃取了密钥，就可以随意加解密收发的数据；
	- 泄露关键在于：第三方截获秘钥后，可以通过**加密仿造有效密文**。
![[对称加密的秘钥安全交换问题示意.png]]

## 特点
- 简单快速

## 问题以及解决
- 存在**秘钥交换**问题： **需要传输秘钥，容易被拦截**，被截获后所有信息都可能*被窃听*。
- [[#非对称加密]]：*保留私钥，只传输公钥*


# 非对称加密
- *加解密使用的密钥不同*：
	-  “*公钥(public key)*”，可以交付给任何人（往往通过数字证书的方式交付）；
	-  “*私钥(private key)*”，需严格保密。
	- 公钥和私钥是 “一对”，称为*密钥对（key pair）*，且具有数学关系。
- 公钥和私钥都可用来加密与解密，但是加解密具有*单向性*：
	- *公钥加密后只能用私钥解密*；
	- *私钥加密后也只能用公钥解密*；
	- 私钥只有自己持有，公钥分发。

![[非对称加密过程示意.png]]
- 持有公钥的人加密后*不能被同样持有公钥的人解析*，即：**无法伪造**秘钥持有人发出的消息。
- 非对称加密算法主要有 `RSA`、`DSA` 等，最著名的是 RSA，在 1977 年，由三位数学家 Rivest、Shamir 和 Adleman 设计。
- RSA 密钥长度一般取 1024 或者 2048 位。

## 特点
- 解决密钥安全交换问题。
- 密钥较长，加解密速度慢。


## 问题以及解决
- Eve 可以拿到 Alice 的公钥，并向其发送消息，**消息可能被篡改**，Alice *无法确认发送者身份*（是不是 Bob）。
- 解决方案 [[#数字签名]]：
	- Bob 能有*独一无二的标志，且能被验证*。
	- Bob 的**私钥是 Bob 独有**的。
	- Bob 用*私钥对邮件内容计算「签名」*，将「签名」和内容一起发送；
	- Alice 用 Bob 的公钥验证签名是否属于 Bob。

# 数字签名
- 假如 bob 要和 alice 通信，非对称加密方式；
- alice 已经持有 Bob 的公钥。
- bob 写信给 alice，采用"*数字签名（signature）*"。先用 Hash 函数，生成信件的*摘要（digest）*；
![[数字签名示意.png]]
- 然后*使用私钥，对 digest 加密，生成"数字签名"（signature）*，并将 signature 附在信件下面，一起发给 alice;
![[生成数字签名示意.png]]
- alice 收信后，取下 signature，*能用鲍勃的公钥解密，得到 digest* ，*证明信确实是 bob 发出的*。
- alice 再对信件使用Hash函数，*得到的 digest 与解密得到的对比*。两者一致，*证明信未被修改过*。
![[数字签名校验示意.png]]



## 问题以及解决
- 无法解决 [[#中间人攻击]]，即：**公钥可能被篡改**（公钥公开了，但是*传递后无法证明是否正确传递到对方*）；
- 解决：**第三方证明 「Bob 的公钥是 Bob 的公钥」**；
	- 实际上是*公钥的数字签名*；
	-  bob 找 **"证书中心"（certificate authority，简称CA）为公钥做认证（证明确实是 Bob ，类似派出所）**：
	- CA 用*自己的私钥，对：*
		-  bob 的公钥；
		- 证书的颁布机构；
		- 有效期；
		- 持有者(subject)等信息
	- 用 CA 的私钥进行签名。生成 *"数字证书"（Digital Certificate）*。
	- Bob 将证书发给 Alice，Alice 用 CA 的公钥对证书进行验证，通过后，拿到 Bob 的公钥。
	- 这样保证了*公钥不会被篡改*。
![[数字证书校验示意.png]]
- bob 的*公钥每次都是从信息中解析得到*，而不是存储在本地，本地则无法替换修改；
- CA 的私钥的保密的，Eve 解密 *Digital Certificate* 后可以修改为自己的公钥，但是却*无法合法的加密、还原*，**非对称加密无法篡改消息内容**。

![[CA证书示意.png]]

# 混合加密
- WebRTC 的 DTLS-SRTP 使用了混合加密的方式：
- 使用[[#非对称加密]]如 RSA 进行共享密钥的安全交换；
- 之后使用[[#对称加密]]进行通信。

# 中间人攻击
- [[#非对称加密]]中，Eve 拿不到 Alice 的私钥，但是可以*得到 Alice 发给 Bob 的公钥（公钥是公开的）*；
- 且黑客 Eve 也可以生成一对密钥，然后把公钥发给 Alice，让 Alice *误以为是 Bob 的公钥*。
- 黑客 Eve 对 Alice 扮演了 Bob 的角色，则以后 Alice 用 “bob 公钥” 加密的信息只有 Eve 能解读，Alice 相当于在和 Eve 通信。
- 这种攻击行为称为[[SSH#中间人攻击|中间人攻击]]。

# 参考
1. [一文彻底搞懂加密、数字签名和数字证书](https://segmentfault.com/a/1190000024523772)