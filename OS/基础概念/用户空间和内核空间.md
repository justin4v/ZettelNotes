#Kernel-space #User-space #Todo 

# 背景

- CPU 指令中*有些是非常危险*的，错用将导致系统崩溃，比如*清内存、设置时钟*等。
- 如果允许所有的程序都可以使用这些指令，系统崩溃的概率将大大增加。  
- 所以，CPU 将指令分为**特权指令和非特权指令**：
	- 可能带来危险的指令，只允许操作系统及其相关模块使用；
	- 普通应用程序只能使用非特权指令。
- 如 Intel 的 CPU 将特权等级分为 4 个级别：Ring0~Ring3。  
- Linux 系统只使用了 Ring0 和 Ring3 两个运行级别(Windows 系统也是一样的)：
	-  Ring3 级别状态称为用户态，Ring0 级别称为内核态。

# 概念
- Kernel space 是 Linux 内核的运行空间，User space 是用户程序的运行空间。
	- 在 32 bit OS 中最高 1G 为内核空间，剩下为用户空间
	- ![[32bit OS 内核和用户空间划分示意.png]]

- 为了操作系统安全，内核空间和用户空间是隔离的，用户的程序崩溃了，内核也不受影响。
- 当进程运行在内核空间时就处于内核态，当进程运行在用户空间时就处于用户态。
- Kernel space 可以执行任意命令，调用系统的一切资源；
- User space 只能执行简单的运算，不能直接调用系统资源，必须通过系统调用（又称 system call），才能向内核发出指令。


# 参考

1. [用户空间和内核空间是什么？](https://cloud.tencent.com/developer/article/1352415)
2. [Linux 内核空间与用户空间](https://www.cnblogs.com/sparkdev/p/8410350.html)