#Mysql #Logic-delete #Physical-delete


# join 查询
- left jion 获取左边所有信息，故左表存在逻辑删除字段时，查询需*先排除已经被逻辑删除的数据*，deleted=0 （1表示已删除）

```sql
-- 错误写法
SELECT a.id,b.id
FROM A a LEFT JOIN B b 
ON a.id=b.a_id WHERE a.deleted=0 AND b.deleted=0
 
 
--正确写法
SELECT a.id,b.id
FROM 
	(SELECT id FROM A WHERE deleted=0) a 
LEFT JOIN
	(SELECT id,a_id FROM B WHERE deleted=0) b 
ON c.id=b.a_id 
```


# 数据恢复
## 利用 binlog 日志
binlog 是记录所有数据库表结构变更（例如CREATE、ALTER TABLE…）以及表数据修改（INSERT、UPDATE、DELETE…）的二进制日志。

使用binlog恢复数据，本质上就是通过binlog找到所有DML操作，去掉错误的SQL语句，然后执行其它的SQL语句，就可以将数据恢复。

  




# 参考
1. [数据库，逻辑删还是物理删？](https://juejin.cn/post/6946577362301485063)
2. [实现数据逻辑删除的一种方案](https://www.cnblogs.com/54chensongxia/p/14247966.html)