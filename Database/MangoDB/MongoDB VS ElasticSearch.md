#MongoDB #Elastic-search #Todo 

# 对比

|          | MongoDB    | ElasticSearch | 备注                                                  |
| -------- | ---------- | ------------- | --------------------------------------------------- |
| 定位       | (文档型)数据库   | (文档型)搜索引擎     | 一个管理数据,一个检索数据                                       |
| 资源占用     | 一般         | 高             | mongo使用c++, es使用Java开发                              |
| 写入延迟     | 低          | 高             | es的写入延迟默认1s, 可配置, 但是要牺牲一些东西                         |
| 全文索引支持度  | 一般         | 非常好           | es本来就是搜索引擎, 这个没啥可比性                                 |
| 有无Schema | 无          | 无             | 两者都是无Schema                                         |
| 支持的数据量   | PB+        | TB+ ~ PB      | 两者支持的量并不好说的太死, 都支持分片和横向扩展, 但是相对来说MongoDB的数据量支持要更大一点 |
| 性能       | 非常好        | 好             | MongoDB在大部分场景性能比es强的多得多                             |
| 索引结构     | B树         | LSM树          | es追求写入吞吐量, MongoDB读写比较均衡                            |
|          |            |               |                                                     |
| 是否支持分片   | 是          | 是             |                                                     |
| 是否支持副本   | 是          | 是             |                                                     |
| 选主算法     | Bully(霸凌)  | Bully(霸凌)     | 相比于Paxos和Raft算法实现更简单并有一定可靠性上的妥协，但是选举速度比较快           |
| 扩展难度     | 容易         | 非常容易          | es真的是我用过的扩展最方便的存储系统之一                               |
| 配置难度     | 难          | 非常容易          |                                                     |
| 地理位置     | 支持         | 支持            |                                                     |
| 运维工具     | 丰富         | 一般            |                                                     |
| 插件和引擎    | 有多个存储引擎供选择 | 有大量插件可以使用     | -                                                   |

# 两者的定位
MongoDB和Elasticsearch都属于NoSQL大家族, 且都属于文档型数据存储

所以这两者的很多功能和特性高度重合, 但其实两者定位完全不同

- MongoDB 是 **文档型数据库**, 提供 **数据存储和管理服务**；
- Elasticsearch 是**搜索引擎**, 提供 **数据检索服务**。

两者的很大区别在于源数据的存储和管理

MongoDB作为一个数据库产品, 是拥有源数据管理能力的
Elasticsearch作为一个搜索引擎, 定位是提供数据检索服务, 也就是说我只管查, 不管写 _, 

Elasticsearch的Mapping不可变也是为此服务的, 带来的代价就是es不适合作为数据管理者, es可以从其他数据源同步数据过来提供查询, 但是不适合自己对数据进行存储和管理
es更侧重数据的查询, 各种复杂的花式查询支持的很好, 相比来说 MongoDB的查询能力就显得比较平庸了

由此可见, 对于个人, 如果你有一批数据要看, 但是不经常进行修改, 这个时候毫无疑问可以用es, 但是如果你还打算继续修改数据, 最好就是使用MongoDB，但其实对大多数人公司来讲，这两者的数据管理能力并没有多大的影响

ps: es修改Mapping的代价非常高, 所以我们一般都是把新数据重新写入一份新索引，然后直接切换读取的别名到新的索引

# 两者读写数据的异同
MongoDB和ElasticSearch都支持全文索引, 虽然MongoDB的全文索引效果完全无法跟es相比(es毕竟是专业的搜索引擎产品, 着重提供数据的检所支持, 这方面吊打MongoDB也是可以理解的)

MongoDB虽然在支持的部分查询功能上稍微弱于es, 但是在大部分场景下性能方面完爆es, 不管是读性能, 还是写性能

es的写入延迟默认为1s, 这个虽然是写入延迟的范畴, 但是毫无疑问是一大缺点, 虽然可以配置为更短的时间, 但是这样就要牺牲一定的数据吞吐量, 会造成更频繁的磁盘刷新操作

es底层使用Lucene作为核心引擎, 很多es的设计就是为了匹配Lucene中的概念, 其实es可以看成一个lucene的proxy层包装,将lucene的原生接口封装的更好用, 同时还实现了很多管理和监控等辅助功能, 但是整体来说es上层的模块和lucene的隔阂还是挺明显的, 耦合度上有一定的欠缺

MongoDB则是完整的一个单体数据库产品, 虽然内部的存储引擎也是可插拔式的, 整体而言还是更加的浑然一体

MongoDB支持多种存储引擎, 本文所有涉及mongo存储引擎的只谈默认的WiredTiger引擎, 其实还有某些方面更优秀的其他引擎,例如: MongoRocks等




# 参考
1. [MongoDB和Elasticsearch的各使用场景对比](https://blog.csdn.net/kongliand/article/details/108691847)