# 工具
借助JOL工具可以看到对象头在加锁状态下的信息。

1. 首先需要使用依赖
```xml
<dependency>
     <groupId>org.openjdk.jol</groupId>
     <artifactId>jol-core</artifactId>
     <version>0.10</version>
</dependency>
```

2. 创建 Person.java
```java
public class Person {

}
```

3. 然后创建 Demo 类

```java
public class MarkTest {

    public static void main(String[] args) {
        Person person = new Person();
        //打印JVM的详细信息
        System.out.println("---JVM的详细信息---");
        System.out.println(VM.current().details());
        //打印对应的对象头信息
        System.out.println("---对象头信息---");
   	         System.out.println(ClassLayout.parseInstance(person).toPrintable());
    }
}
```

运行的结果如下
![[JOL查看对象头.png]]

不是说Klass是64bits(8个字节)但是这儿只有4个字节，因为默认情况下是开启压缩指针的，我们可以通过JVM运行参数`-XX:-UseCompressedOops`来关闭压缩指针，这样Klass就是8个字节了。我们可以看到整个对象是16个字节，其中对象头（object header）12B(12个字节)，还有4B是对齐的字节（因为在64位虚拟机上对象的大小必须是**8的倍数**），由于这个对象里面没有任何字段，故而对象的实例数据为0B。现在的锁状态是01，表示无锁状态。注意因为是**小端存储**，所以你看的值是倒过来的。前25bit没有使用所以都是0，后面31bit存的hashcode，所以第一个字节中八位存储的分别就是分代年龄、偏向锁信息、对象状态