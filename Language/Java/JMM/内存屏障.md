#Todo #JVM #Memory-Barriers


# volatile 内存屏障

```java
class X {
    
int a, b;
    
volatile int v, u;
    
void f() {     
int i, j;

    i = a;
// load a  普通load
    j = b;
// load b  普通load
    i = v;
// load v  volatile load
        
// LoadLoad
    j = u;
// load u  volatile load
        
// LoadStore
    a = i;
// store a 普通store  
    b = j;
// store b 普通store
        
// StoreStore
    v = i;
// store v volatile store
        
// StoreStore
    u = j;
// store u volatile store
        
// StoreLoad
    i = u;
// load u  volatile load
        
// 两个屏障 LoadLoad 和 LoadStore
    j = b;
// load b  普通load
    a = i;
// store a 普通store
    }
}
```


# 参考
1. [内存屏障 · JVM (gitbooks.io)](https://luoyoubao.gitbooks.io/jvm/content/javanei-cun-mo-xing/nei-cun-ping-zhang.html)
2. [JMM中的重排序及内存屏障](https://www.cnblogs.com/wuqinglong/p/9947786.html)