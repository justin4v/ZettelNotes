# 简介

CAS，比较并交换（Conmpare And Swap）是用于实现多线程同步的原子指令。
它将内存位置的内容与给定值进行比较，只有在相同的情况下，将该内存位置的内容修改为新的给定值。这是作为单个原子操作完成的。

# 操作
假设内存中的原数据V，旧的预期值A，需要修改的新值B。
1. 比较 A 与 V 是否相等；
2. 如果相等，将 B 写入 V；
3. 返回操作是否成功。
4. 当多个线程同时对某个资源进行CAS操作，只能有一个线程操作成功，但是并不会阻塞其他线程,其他线程只会收到操作失败的信号。CAS 其实是一个乐观锁

![[CAS操作过程示意.png]]

CAS的核心是在将B值写入到V之前要比较A值和V值是否相同，如果*不相同证明此时 V 值已经被其他线程修改*。

# CAS 实现
Java 中调用 Unsafe 的 compareAndSwapInt 的方法实现 CAS。
