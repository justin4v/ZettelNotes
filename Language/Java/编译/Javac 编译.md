# 编译过程

 不论是物理机还是虚拟机，大部分的程序代码从开始编译到最终转化成物理机的目标代码或虚拟机能执行的指令集之前，都会按照如下图所示的各个步骤进行：
 
 ![[一般的编译步骤.png]]
 
 其中绿色的模块可以选择性实现。
 可以看出：
 1. 图中的分支是解释执行的过程（即一条字节码一条字节码地解释执行，如JavaScript）；
 2. 下面的分支就是传统编译原理中从源代码到目标机器代码的生成过程。
 3. 如今基于物理机、虚拟机等的语言，*大多都遵循这种基于现代经典编译原理的思路*，在执行前先对程序源码进行词法解析和语法解析处理，把源码转化为抽象语法树。
 
 对于一门具体语言的实现来说，词法和语法分析乃至后面的优化器和目标代码生成器都可以选择独立于执行引擎，形成一个完整意义的编译器去实现，这类代表是C/C++语言。
 也可以把抽象语法树或指令流之前的步骤实现一个半独立的编译器，这类代表是Java语言。又或者可以把这些步骤和执行引擎全部集中在一起实现，如大多数的JavaScript执行器。